select a.orbit, min(overpass_time at time zone 'UTC') from rainy100inside100 a, orbit_subset_product b where a.orbit=b.orbit and b.product_type='2A12' and a.orbit > (select COALESCE( max(orbit), 0) from modelgrids where model='NAMANL' and filetype='GRIB') group by 1 order by 1;

CREATE VIEW rainy100by2a53 AS select a.radar_id, a.orbit, a.overpass_time, b.value as numrain from overpass_event a JOIN event_meta_numeric b ON a.event_num = b.event_num AND b.metadata_id = 531005 and b.value > 100 order by 3 desc;

select a.orbit, min(overpass_time at time zone 'UTC') from rainy100inside100 a, orbit_subset_product b where a.orbit=b.orbit and b.product_type='2A12' and a.orbit > (select COALESCE( max(orbit), 0) from modelgrids where model='NAMANL' and filetype='GRIB') group by a.orbit UNION select a.orbit, min(overpass_time at time zone 'UTC') from rainy100by2a53 a, orbit_subset_product b where a.orbit=b.orbit and b.product_type='2A12' and a.orbit > (select COALESCE( max(orbit), 0) from modelgrids where model='NAMANL' and filetype='GRIB') group by a.orbit order by 1;

select a.orbit, min(overpass_time at time zone 'UTC') from rainy100inside100 a, orbit_subset_product b where a.orbit=b.orbit and b.product_type='2A12' and not exists(select * from modelgrids m where b.orbit=m.orbit and model='NAMANL' and filetype='GRIB') group by a.orbit UNION select a.orbit, min(overpass_time at time zone 'UTC') from rainy100by2a53 a, orbit_subset_product b where a.orbit=b.orbit and b.product_type='2A12' and not exists(select * from modelgrids m where b.orbit=m.orbit and model='NAMANL' and filetype='GRIB') group by a.orbit order by 1;
